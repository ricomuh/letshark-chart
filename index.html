<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ChartJS Example</title>
  </head>
  <body>
    <div>
      <canvas id="weightLengthChart" width="600" height="800"></canvas>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.7.0"></script>
    <script src="./node_modules/chartjs-plugin-annotation/dist/chartjs-plugin-annotation.min.js"></script>

    <script>
      const ctx = document.getElementById("weightLengthChart").getContext("2d");
      const weightLengthChart = new Chart(ctx, {
        type: "line",
        data: {
          labels: Array.from({ length: 24 }, (_, i) => i + 1), // x-axis labels 1-24 (for 2 years)
          datasets: [
            {
              label: "-3",
              borderColor: "black",
              data: [
                2.5, 3, 4, 5, 5.8, 6.5, 7.5, 8.5, 9.3, 10.5, 12, 14, 16, 18, 19,
                19.5, 20, 20.5, 21, 21.5, 22, 22.5, 23, 23.5,
              ],
              fill: false,
              tension: 0.4,
            },
            {
              label: "-2",
              borderColor: "red",
              data: [
                3, 3.8, 4.8, 5.5, 6.5, 7.3, 8.2, 9.2, 10.3, 11.5, 13, 15, 17,
                19, 20, 20.5, 21, 21.5, 22, 22.5, 23, 23.5, 24, 24.5,
              ],
              fill: false,
              tension: 0.4,
            },
            {
              label: "-1",
              borderColor: "orange",
              data: [
                3.5, 4.2, 5.2, 6.2, 7, 7.9, 9, 10, 11.2, 12.5, 14.5, 16.5, 18,
                20, 21, 21.5, 22, 22.5, 23, 23.5, 24, 24.5, 25, 25.5,
              ],
              fill: false,
              tension: 0.4,
            },
            {
              label: "0",
              borderColor: "green",
              data: [
                4, 5, 6, 7, 8, 9, 10, 11, 12.2, 13.5, 15.5, 17.5, 20, 22, 23,
                23.5, 24, 24.5, 25, 25.5, 26, 26.5, 27, 27.5,
              ],
              fill: false,
              tension: 0.4,
            },
            {
              label: "1",
              borderColor: "red",
              data: [
                4.5, 5.5, 6.5, 7.5, 8.8, 9.9, 11, 12.5, 13.5, 15, 17, 19, 21,
                23, 24, 24.5, 25, 25.5, 26, 26.5, 27, 27.5, 28, 28.5,
              ],
              fill: false,
              tension: 0.4,
            },
            {
              label: "2",
              borderColor: "orange",
              data: [
                5, 6, 7.2, 8.5, 9.5, 10.8, 12.5, 13.5, 14.8, 16.5, 19, 21, 23,
                24, 25, 25.5, 26, 26.5, 27, 27.5, 28, 28.5, 29, 29.5,
              ],
              fill: false,
              tension: 0.4,
            },
            {
              label: "3",
              borderColor: "black",
              data: [
                5.5, 6.5, 7.8, 9.2, 10.5, 11.8, 13, 14.5, 16, 17.5, 20, 22, 24,
                25, 26, 26.5, 27, 27.5, 28, 28.5, 29, 29.5, 30, 30.5,
              ],
              fill: false,
              tension: 0,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false, // Allows height customization
          scales: {
            x: {
              title: {
                display: true,
                text: "Length (cm)",
              },
              grid: {
                display: true,
                color: "#ccc",
                borderDash: [5, 5], // Dotted lines for the grid
                lineWidth: 1,
              },
              ticks: {
                stepSize: 1,
              },
            },
            y: {
              title: {
                display: true,
                text: "Weight (kg)",
              },
              grid: {
                display: true,
                color: "#ccc",
                borderDash: [5, 5],
                lineWidth: 1,
              },
              ticks: {
                stepSize: 1,
              },
              beginAtZero: true,
            },
          },
          plugins: {
            datalabels: {
              formatter: function (value, context) {
                if (context.dataIndex === context.dataset.data.length - 1) {
                  return context.dataset.label; // Show z-score at the last point
                }
                return "";
              },
              align: "top",
              anchor: "end",
            },
            annotation: {
              annotation: {
                annotations: {
                  dividerLine: {
                    type: "line",
                    scaleID: "x",
                    value: 12, // Divider after 1 year
                    borderColor: "blue",
                    borderWidth: 2,
                    borderDash: [5, 5],
                    label: {
                      content: "1 Year",
                      enabled: true,
                      position: "start",
                      backgroundColor: "rgba(0, 0, 0, 1)",
                    },
                  },
                  indicatorLine1: {
                    type: "line",
                    scaleID: "x",
                    value: 24, // Last point
                    borderColor: "red",
                    borderWidth: 2,
                    borderDash: [5, 5],
                    label: {
                      content: "-3",
                      enabled: true,
                      position: "start",
                      backgroundColor: "rgba(255, 0, 0, 0.1)",
                    },
                  },
                  indicatorLine2: {
                    type: "line",
                    scaleID: "x",
                    value: 24, // Last point
                    borderColor: "green",
                    borderWidth: 2,
                    borderDash: [5, 5],
                    label: {
                      content: "-2",
                      enabled: true,
                      position: "start",
                      backgroundColor: "rgba(0, 255, 0, 0.1)",
                    },
                  },
                  indicatorLine3: {
                    type: "line",
                    scaleID: "x",
                    value: 24, // Last point
                    borderColor: "yellow",
                    borderWidth: 2,
                    borderDash: [5, 5],
                    label: {
                      content: "0",
                      enabled: true,
                      position: "start",
                      backgroundColor: "rgba(255, 255, 0, 0.1)",
                    },
                  },
                  indicatorLine4: {
                    type: "line",
                    scaleID: "x",
                    value: 24, // Last point
                    borderColor: "purple",
                    borderWidth: 2,
                    borderDash: [5, 5],
                    label: {
                      content: "2",
                      enabled: true,
                      position: "start",
                      backgroundColor: "rgba(128, 0, 128, 0.1)",
                    },
                  },
                  indicatorLine5: {
                    type: "line",
                    scaleID: "x",
                    value: 24, // Last point
                    borderColor: "orange",
                    borderWidth: 2,
                    borderDash: [5, 5],
                    label: {
                      content: "3",
                      enabled: true,
                      position: "start",
                      backgroundColor: "rgba(255, 165, 0, 0.1)",
                    },
                  },
                },
              },
            },
            tooltip: {
              callbacks: {
                title: function () {
                  return ""; // Hide the title by returning an empty string
                },
                label: function (tooltipItem) {
                  const weight = "Weight = " + tooltipItem.raw + " kg";
                  const length = "Length = " + tooltipItem.label + " cm";
                  const zScore = "Z-score = " + tooltipItem.dataset.label;

                  return [weight, length, zScore];
                },
              },
              displayColors: false, // Remove color box in the tooltip
              bodyFont: {
                size: 14, // Adjust font size for readability
              },
            },
          },
        },
      });
    </script>
  </body>
</html>
